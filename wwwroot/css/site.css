/* Global Refinements */
:root {
    --brand-primary: #a19482;
    /* Tan */
    --brand-secondary: #66615c;
    /* Dark Tan */
    --brand-accent: #fbbf24;
    /* Yellow-400 for active state */
    --brand-dark: #000000;
    /* Black */
    --brand-text-light: #ffffff;
    --sidebar-width: 260px;
    --sidebar-width-collapsed: 80px;
}

body {
    background-color: #f4f6f9;
    /* Light gray background */
}

/* Prevent Transition on Load (FOUC Fix) */
.no-transition,
.no-transition * {
    transition: none !important;
}

/* -------------------------------------------------------------------------- */
/*                               LAYOUT ENGINE                                */
/* -------------------------------------------------------------------------- */

/* Grid Layout Container */
body {
    display: grid;
    /* Grid: Sidebar | Content */
    grid-template-columns: var(--sidebar-width) 1fr;
    grid-template-rows: 1fr;
    min-height: 100vh;
    margin: 0;
    overflow-x: hidden;
    transition: grid-template-columns 0.55s cubic-bezier(0.4, 0, 0.2, 1);
    /* Final Polish: 0.55s */
}

/* Sidebar - Grid Area 1 */
.app-sidebar {
    background-color: var(--brand-dark) !important;
    color: var(--brand-text-light);
    border-right: 1px solid var(--brand-primary);
    width: 100%;
    /* Fill Grid Info */
    height: 100vh;
    position: sticky;
    top: 0;
    z-index: 1040;
    display: flex;
    flex-direction: column;
    overflow: visible;
}

.sidebar-brand {
    height: 70px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    /* Left Align */
    padding-left: 16px;
    /* Match Nav Link Padding */
    border-bottom: 1px solid #2c2c2c;
    flex-shrink: 0;
    overflow: hidden;
    transition: padding-left 0.55s cubic-bezier(0.4, 0, 0.2, 1);
}

body.sidebar-collapse .sidebar-brand {
    padding-left: 0;
    /* Remove padding for centered small logo */
    justify-content: center;
}

.sidebar-wrapper {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-width: none;
    padding-top: 1rem;
}

/* Navigation Links (Sidebar Only) */
.app-sidebar .nav-link {
    color: #9ca3af !important;
    padding: 12px 16px;
    display: flex;
    align-items: center;
    transition: all 0.2s, padding-left 0.55s cubic-bezier(0.4, 0, 0.2, 1);
    border-left: 4px solid transparent;
    white-space: nowrap;
    overflow: hidden;
    /* Essential for smooth collapse */
}

/* Sidebar Text Alignment & Transition */
.app-sidebar .nav-link p {
    margin-bottom: 0;
    line-height: 1.2;
    opacity: 1;
    max-width: 200px;
    /* Arbitrary large width for text */
    transition: opacity 0.55s cubic-bezier(0.4, 0, 0.2, 1), max-width 0.55s cubic-bezier(0.4, 0, 0.2, 1);
    /* Final Polish: 0.55s */
}

/* Sidebar Hover State */
.app-sidebar .nav-link:hover {
    color: #fff !important;
    background-color: rgba(255, 255, 255, 0.1);
}

.app-sidebar .nav-link:hover .nav-icon {
    color: #fff !important;
}

.app-sidebar .nav-icon {
    margin-right: 12px;
    width: 20px;
    height: 20px;
    color: #9ca3af;
    transition: color 0.2s, margin-right 0.55s cubic-bezier(0.4, 0, 0.2, 1);
    /* Final Polish: 0.55s */
    /* Smooth icon slide */
    flex-shrink: 0;
}

/* Main Content - Grid Area 2 */
#main-content-wrapper {
    display: flex;
    flex-direction: column;
    background-color: #f4f6f9;
    width: 100%;
    min-width: 0;
    /* Prevent grid blowout */
    height: 100%;
    /* Ensure fill */
    min-height: 100vh;
    overflow-x: hidden;
}

/* -------------------------------------------------------------------------- */
/*                              COLLAPSED STATE                               */
/* -------------------------------------------------------------------------- */

body.sidebar-collapse {
    grid-template-columns: var(--sidebar-width-collapsed) 1fr;
}

/* Hide Large Logo Text/Image (Keep instant for now to avoid artifacting) */
body.sidebar-collapse .sidebar-brand .brand-text,
body.sidebar-collapse .sidebar-brand .brand-link .brand-image {
    display: none !important;
    width: 0 !important;
    visibility: hidden !important;
}

/* Show Small Logo */
body.sidebar-collapse .brand-link-small {
    display: flex !important;
    align-items: center;
    justify-content: flex-start;
    /* Left Align */
    padding-left: 0;
    /* Reset padding, parent handles offset */
    width: 100%;
}

body.sidebar-collapse .sidebar-brand {
    padding-left: 14px;
    /* Center 52px Logo in 80px space ((80-52)/2 = 14px) */
    justify-content: flex-start;
    /* Keep left align */
}

/* -------------------------------------------------------------------------- */
/*                          SMOOTH COLLAPSE LOGIC                             */
/* -------------------------------------------------------------------------- */

/* Hide Text Smoothly */
body.sidebar-collapse .nav-link p {
    opacity: 0;
    max-width: 0;
}

/* Center Icons Smoothly via Padding */
body.sidebar-collapse .nav-link {
    padding-left: 30px !important;
    /* Center 20px Icon in 80px space ((80-20)/2 = 30px) */
}

body.sidebar-collapse .nav-icon {
    margin-right: 0;
}

/* Header Navigation Links (Override Generic) */
.app-header {
    min-height: 70px;
    /* Match Sidebar Brand Height */
    display: flex;
    align-items: center;
    /* Ensure vertical centering */
    padding-top: 0 !important;
    padding-bottom: 0 !important;
}

.app-header .nav-link {
    color: #6c757d !important;
    /* Bootstrap Secondary */
    padding: 8px 12px;
    display: flex;
    align-items: center;
    transition: color 0.2s;
}

.app-header .nav-link:hover {
    color: var(--brand-dark) !important;
    /* Dark on Hover */
    background-color: transparent !important;
    /* No BG on header hover */
}

/* Center Sidebar Toggle Icon vertically */
.sidebar-floating-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Toggle Icon Logic (CSS Only) */
.toggle-icon-collapsed {
    display: none;
    /* Hide 'collapsed' icon by default (sidebar is open) */
}

body.sidebar-collapse .toggle-icon-expanded {
    display: none;
    /* Hide 'open' icon when collapsed */
}

body.sidebar-collapse .toggle-icon-collapsed {
    display: block;
    /* Show 'collapsed' icon when collapsed */
}

/* Floating Toggle Button */
.sidebar-floating-toggle {
    position: absolute;
    right: -12px;
    top: 76px;
    /* 6px below 70px Header */
    width: 24px;
    height: 24px;
    background-color: var(--brand-primary);
    color: white;
    border: 1px solid #000;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 1050;
    transition: transform 0.2s;
}

.sidebar-floating-toggle:hover {
    transform: scale(1.1);
    background-color: #fff;
    color: #000;
}

/* -------------------------------------------------------------------------- */
/*                          HYBRID DASHBOARD CARDS                            */
/* -------------------------------------------------------------------------- */

.small-box {
    border-radius: 0.5rem;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    display: block;
    margin-bottom: 20px;
    position: relative;
    background-color: #fff !important;
    /* STRICT WHITE BG */
    color: var(--brand-dark) !important;
    border-top: 4px solid var(--brand-primary);
    /* Tan Top Border */
    overflow: hidden;
    transition: transform 0.2s;
    text-decoration: none;
}

.small-box:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.small-box .inner {
    padding: 20px;
    z-index: 2;
    position: relative;
}

.small-box h3 {
    font-size: 2.2rem;
    font-weight: 700;
    margin: 0 0 5px 0;
    white-space: nowrap;
    color: var(--brand-dark);
}

.small-box p {
    font-size: 1rem;
    font-weight: 500;
    color: #6b7280;
    margin-bottom: 0;
}

/* Large Faded Icon (Background Watermark) */
.small-box .icon {
    position: absolute;
    right: 10px;
    top: 10px;
    z-index: 0;
    /* Behind text (z-index 2 is on .inner) */
    color: var(--brand-dark) !important;
    opacity: 0.10;
    /* Slightly more visible since smaller */
    transition: all 0.3s linear;
}

.small-box .icon>i,
.small-box .icon>svg {
    width: 70px !important;
    /* Reduced to ~70px for subtle look */
    height: 70px !important;
    display: block;
}

.small-box:hover .icon {
    transform: scale(1.1);
    opacity: 0.25;
}

/* Footer Link */
.small-box-footer {
    background-color: var(--brand-primary) !important;
    color: #fff !important;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 8px 0;
    text-align: center;
    text-decoration: none;
    z-index: 10;
    font-size: 0.875rem;
    font-weight: 500;
    transition: background-color 0.1s;
}

.small-box-footer:hover {
    background-color: var(--brand-secondary) !important;
    color: #fff !important;
}

.small-box-footer i,
.small-box-footer svg {
    width: 24px;
    /* Increased to 24px for visual weight balance */
    height: 24px;
}

/* Status: Warning (Pending) */
.small-box.status-warning {
    border-top-color: var(--brand-accent) !important;
}

.small-box.status-warning .small-box-footer {
    background-color: #e5a00d !important;
}

/* Darker Hover for Warning */
.small-box.status-warning .small-box-footer:hover {
    background-color: #c68c0b !important;
}

.small-box.status-warning .icon {
    color: var(--brand-accent) !important;
}

/* Status: Danger (Expiring) */
.small-box.status-danger {
    border-top-color: #dc3545 !important;
}

.small-box.status-danger .small-box-footer {
    background-color: #dc3545 !important;
}

/* Darker Hover for Danger */
.small-box.status-danger .small-box-footer:hover {
    background-color: #b02a37 !important;
}

.small-box.status-danger .icon {
    color: #dc3545 !important;
}

.form-floating>.form-control-plaintext::placeholder,
.form-floating>.form-control::placeholder {
    color: var(--bs-secondary-color);
    text-align: end;
}

.form-floating>.form-control-plaintext:focus::placeholder,
.form-floating>.form-control::focus::placeholder {
    text-align: start;
}

/* -------------------------------------------------------------------------- */
/*                              BRAND BUTTONS                                 */
/* -------------------------------------------------------------------------- */

.btn-outline-brand {
    color: var(--brand-primary);
    border-color: var(--brand-primary);
    background-color: transparent;
}

.btn-outline-brand:hover,
.btn-outline-brand:active,
.btn-outline-brand:focus {
    color: #fff;
    background-color: var(--brand-primary);
    border-color: var(--brand-primary);
}

.btn-brand {
    color: #fff;
    background-color: var(--brand-primary);
    border-color: var(--brand-primary);
}

.btn-brand:hover,
.btn-brand:active,
.btn-brand:focus {
    color: #fff;
    background-color: var(--brand-secondary);
    border-color: var(--brand-secondary);
}

/* Pagination Styling to match Brand */
.page-link.active,
.active>.page-link {
    background-color: var(--brand-primary);
    border-color: var(--brand-primary);
    color: #fff;
}

.page-link {
    color: var(--brand-primary);
}

.page-link:hover {
    color: var(--brand-secondary);
}

/* -------------------------------------------------------------------------- */
/*                            ACCORDION OVERRIDES                             */
/* -------------------------------------------------------------------------- */

/* -------------------------------------------------------------------------- */
/*                            ACCORDION OVERRIDES                             */
/* -------------------------------------------------------------------------- */

.accordion-button:focus {
    z-index: 3;
    border-color: var(--brand-primary);
    outline: 0;
    box-shadow: 0 0 0 0.25rem rgba(161, 148, 130, 0.25);
    /* Brand Primary 25% */
    color: var(--brand-dark);
    /* Keep text dark on focus */
    background-color: #fff;
    /* Keep background white */
}

.accordion-button:not(.collapsed) {
    color: var(--brand-dark);
    background-color: #fff;
    /* Prevent default blueish tint */
    box-shadow: inset 0 -1px 0 rgba(0, 0, 0, .125);
}

/* -------------------------------------------------------------------------- */
/*                          GLOBAL FOCUS OVERRIDES                            */
/* -------------------------------------------------------------------------- */

/* Inputs & Selects */
.form-control:focus,
.form-select:focus {
    border-color: var(--brand-primary);
    box-shadow: 0 0 0 0.25rem rgba(161, 148, 130, 0.25);
}

/* Checkboxes & Radios */
.form-check-input:checked {
    background-color: var(--brand-primary);
    border-color: var(--brand-primary);
}

.form-check-input:focus {
    border-color: var(--brand-primary);
    box-shadow: 0 0 0 0.25rem rgba(161, 148, 130, 0.25);
}

/* Buttons (Generic) */
.btn-check:focus+.btn,
.btn:focus {
    background-color: var(--brand-secondary);
    border-color: var(--brand-secondary);
    color: #fff;
    box-shadow: 0 0 0 0.25rem rgba(161, 148, 130, 0.25);
}

/* Brand Buttons Specifics (Ensure they don't get messy) */
.btn-brand:focus,
.btn-outline-brand:focus {
    box-shadow: 0 0 0 0.25rem rgba(161, 148, 130, 0.25);
}

/* Close Buttons (Modals/Alerts) */
.btn-close:focus {
    box-shadow: 0 0 0 0.25rem rgba(161, 148, 130, 0.25);
}

/* Links */
a:focus {
    outline: none;
    /* Often browser default is enough, but if custom focus is needed: */
    /* box-shadow: 0 0 0 0.25rem rgba(161, 148, 130, 0.25); */
}