<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - HR Certification Portal</title>
    
    <!-- Fonts -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@@fontsource/source-sans-3@@5.0.12/index.css" crossorigin="anonymous" />
    
    <!-- Plugins -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.11.0/styles/overlayscrollbars.min.css" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" crossorigin="anonymous" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="~/css/site.css?v=2" />
</head>
<body class="bg-body-tertiary">
    <script>
        // Immediate State Restoration to prevent FOUC
        const savedState = localStorage.getItem('sidebar-collapse');
        if (savedState === 'true') {
            document.body.classList.add('sidebar-collapse');
        }
    </script>

    <!-- Grid Layout: Sidebar + Main Content -->
    
    <!-- Sidebar -->
    <partial name="_Sidebar" />

    <!-- Main Content Wrapper -->
    <div id="main-content-wrapper">
            
            <!-- Header -->
            <nav class="app-header navbar navbar-expand bg-body shadow-sm">
                <div class="container-fluid">
                    <!-- Left: Page Title -->
                    <ul class="navbar-nav align-items-center">
                        <li class="nav-item d-none d-md-block ms-2">
                            <h4 class="mb-0 text-muted">@ViewData["Title"]</h4>
                        </li>
                    </ul>

                    <!-- Right: Search & User Actions -->
                    <ul class="navbar-nav ms-auto gap-3">
                        <!-- Search Bar -->
                        <li class="nav-item d-none d-md-block">
                            <form class="d-flex" role="search">
                                <div class="input-group">
                                    <input class="form-control" type="search" placeholder="Search..." aria-label="Search">
                                    <button class="btn btn-outline-secondary" type="submit">
                                        <i data-lucide="search"></i>
                                    </button>
                                </div>
                            </form>
                        </li>
                        
                        <!-- Notifications -->
                        <li class="nav-item dropdown">
                            <a class="nav-link" data-bs-toggle="dropdown" href="#">
                                <i data-lucide="bell"></i>
                                <span class="navbar-badge badge text-bg-warning rounded-pill position-absolute top-0 start-100 translate-middle">3</span>
                            </a>
                             <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end">
                                <span class="dropdown-item dropdown-header">3 Notifications</span>
                                <div class="dropdown-divider"></div>
                                <a href="#" class="dropdown-item">
                                    <i data-lucide="file-text" class="me-2"></i> 2 new requests
                                    <span class="float-end text-muted text-sm">3 mins</span>
                                </a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="#" data-lte-toggle="fullscreen">
                                <i data-lucide="maximize" class="bi bi-arrows-fullscreen"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main Application Content -->
            <main class="app-main flex-grow-1 p-4">
                <div class="container-fluid">
                    @RenderBody()
                </div>
            </main>

            <!-- Footer -->
            <footer class="app-footer py-3 bg-white border-top text-center text-sm text-muted">
                <strong>Copyright &copy; @DateTime.Now.Year Specialized Engineering.</strong> All rights reserved.
            </footer>
        </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@@2.11.0/browser/overlayscrollbars.browser.es6.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@@2.11.8/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@@5.3.7/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/lucide@latest"></script> <!-- Lucide Icons -->
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize Lucide Icons
            lucide.createIcons();

            // Toggle Logic
            const toggleBtn = document.querySelector('.sidebar-floating-toggle');
            const sidebar = document.querySelector('.app-sidebar');
            const mainContent = document.getElementById('main-content-wrapper');
            const toggleIcon = document.getElementById('sidebar-toggle-icon');
            const brandText = document.querySelector('.brand-text');
            const brandLogoSmall = document.querySelector('.brand-link-small');
            const brandLogoDefault = document.querySelector('.brand-link-default');

            if (toggleBtn) {
                toggleBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.body.classList.toggle('sidebar-collapse');
                    
                    const isCollapsed = document.body.classList.contains('sidebar-collapse');
                    
                    // Save State
                    localStorage.setItem('sidebar-collapse', isCollapsed);
                });
            }
        });
    </script>
    
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
